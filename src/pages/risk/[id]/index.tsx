import Head from "next/head";
import { useRouter } from "next/router";
import { useSession } from "next-auth/react";
import Header from "~/components/Header";
import Container from "~/components/Container";
import { api } from "~/utils/api";
import { Footer } from "~/components/Footer";
import Link from "next/link";

const tableClass = "text-left pl-2 py-2";
const tableClassBold = "text-left pl-2 py-2 font-bold";
const planDetailsClass =
  "divide-x divide-white odd:bg-slate-100 even:bg-tertiary-lt";
const designDetailsClass =
  "divide-x divide-white odd:bg-slate-100 even:bg-secondary-lt";
const financialDetailsClass =
  "divide-x divide-white odd:bg-slate-100 even:bg-danger-lt";
const adminDetailsClass =
  "divide-x divide-white odd:bg-slate-100 even:bg-info-lt";

export default function RiskPlan() {
  const { data: sessionData, status } = useSession();
  const { id } = useRouter().query;
  const idString = typeof id === "string" ? id : "";

  const { data: riskPlanDetails } =
    api.riskPlan.getRiskPlanDetailsById.useQuery({
      riskPlanId: Number(idString),
    });

  return (
    <>
      <Head>
        <title>Benefitsphere - Risk Benefit</title>
        <meta name="description" content="Generated by create-t3-app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className="text-primary">
        <Header />
        <Container>
          {riskPlanDetails && (
            <div>
              <div className="flex justify-between">
                <h1 className="text-3xl font-bold">Life Plan Details</h1>
                <Link
                  href={`/risk/${idString}/edit`}
                  className="rounded-lg bg-primary px-4 py-1 text-lg font-bold text-white hover:bg-tertiary"
                >
                  Edit
                </Link>
              </div>
              <div className="ml-4">
                <div>
                  <h2 className="my-4 block text-xl font-semibold ">
                    Plan Information
                  </h2>
                  <table className="min-w-full divide-x divide-y divide-white ">
                    <thead>
                      <tr className="divide-x divide-white bg-primary text-white">
                        <th className="w-1/4 py-2 pl-2 text-left">Category</th>
                        <th className="w-3/4 py-2 pl-2 text-left">
                          Description
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr className={planDetailsClass}>
                        <td className={tableClassBold}>Country</td>
                        <td className={tableClass}>
                          {riskPlanDetails.country}
                        </td>
                      </tr>
                      <tr className={planDetailsClass}>
                        <td className={tableClassBold}>Currency</td>
                        <td className={tableClass}>
                          {riskPlanDetails.currency}
                        </td>
                      </tr>
                      <tr className={planDetailsClass}>
                        <td className={tableClassBold}>
                          Is this a supplemental group benefit?
                        </td>
                        <td className={tableClass}>Yes</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
                <div>
                  <h2 className="my-4 block text-xl font-semibold text-secondary">
                    Design Details
                  </h2>
                  <table className="min-w-full divide-x divide-y divide-white ">
                    <thead>
                      <tr className="divide-x divide-white bg-secondary text-white">
                        <th className="w-1/4 py-2 pl-2 text-left">Category</th>
                        <th className="w-3/4 py-2 pl-2 text-left">
                          Description
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr className={designDetailsClass}>
                        <td className={tableClassBold}>Coverage Type</td>
                        <td className={tableClass}>
                          {riskPlanDetails.coverageType}
                        </td>
                      </tr>
                      <tr className={designDetailsClass}>
                        <td className={tableClassBold}>Eligibility</td>
                        <td className={tableClass}>
                          {riskPlanDetails.eligibility}
                        </td>
                      </tr>
                      <tr className={designDetailsClass}>
                        <td className={tableClassBold}>Benefit Form</td>
                        <td className={tableClass}>
                          {riskPlanDetails.coverageForm}
                        </td>
                      </tr>
                      <tr className={designDetailsClass}>
                        <td className={tableClassBold}>Benefit Description</td>
                        <td className={tableClass}>
                          {riskPlanDetails.coverageForm === "" && (
                            <div className="flex">No details provided yet!</div>
                          )}
                          {riskPlanDetails.coverageForm === "Fixed Amount" && (
                            <div className="flex">
                              {riskPlanDetails.coverageFixedAmount}
                            </div>
                          )}
                          {riskPlanDetails.coverageForm ===
                            "Salary Multiple" && (
                            <div className="flex">
                              {riskPlanDetails.coverageMultiple} X{" "}
                              {riskPlanDetails.coverageMultipleDuration}
                            </div>
                          )}
                        </td>
                      </tr>
                      <tr className={designDetailsClass}>
                        <td className={tableClassBold}>Non-evidence Limit</td>
                        <td className={tableClass}>
                          CAD {riskPlanDetails.nonEvidenceLimit}
                        </td>
                      </tr>
                      <tr className={designDetailsClass}>
                        <td className={tableClassBold}>Benefit Maximum</td>
                        <td className={tableClass}>
                          CAD {riskPlanDetails.coverageMaximum}
                        </td>
                      </tr>
                      <tr className={designDetailsClass}>
                        <td className={tableClassBold}>
                          Employee Contribution
                        </td>
                        <td className={tableClass}>
                          {riskPlanDetails.employeeContribution}
                          {riskPlanDetails.employeeContribution === "Other" && (
                            <span>
                              {riskPlanDetails.employeeContributionOther}
                            </span>
                          )}
                        </td>
                      </tr>
                      <tr className={designDetailsClass}>
                        <td className={tableClassBold}>
                          Employer Contribution
                        </td>
                        <td className={tableClass}>
                          {riskPlanDetails.employerContribution}
                          {riskPlanDetails.employerContribution === "Other" && (
                            <span>
                              {riskPlanDetails.employerContributionOther}
                            </span>
                          )}
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <div>
                  <h2 className="my-4 block text-xl font-semibold text-danger ">
                    Financial Details
                  </h2>
                  <table className="min-w-full divide-x divide-y divide-white ">
                    <thead>
                      <tr className="divide-x divide-white bg-danger text-white">
                        <th className="w-1/4 py-2 pl-2 text-left">Category</th>
                        <th className="w-3/4 py-2 pl-2 text-left">
                          Description
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr className={financialDetailsClass}>
                        <td className={tableClassBold}>Insurer</td>
                        <td className={tableClass}>
                          {riskPlanDetails.provider}
                        </td>
                      </tr>
                      <tr className={financialDetailsClass}>
                        <td className={tableClassBold}>Policy Number</td>
                        <td className={tableClass}>
                          {riskPlanDetails.policyNumber}
                        </td>
                      </tr>
                      <tr className={financialDetailsClass}>
                        <td className={tableClassBold}>Policy Period</td>
                        <td className={tableClass}>
                          {riskPlanDetails.policyStartDate
                            .toISOString()
                            .substr(0, 10)}{" "}
                          to{" "}
                          {riskPlanDetails.policyEndDate
                            .toISOString()
                            .substr(0, 10)}
                        </td>
                      </tr>
                      <tr className={financialDetailsClass}>
                        <td className={tableClassBold}>Intermediaries</td>
                        <td className={tableClass}>
                          {riskPlanDetails.intermediaryType}
                        </td>
                      </tr>
                      <tr className={financialDetailsClass}>
                        <td className={tableClassBold}>Intermediary</td>
                        <td className={tableClass}>
                          {riskPlanDetails.intermediaryName}
                        </td>
                      </tr>
                      <tr className={financialDetailsClass}>
                        <td className={tableClassBold}>Remuneration Method</td>
                        <td className={tableClass}>
                          {riskPlanDetails.intermediaryRemunerationMethod}
                        </td>
                      </tr>
                      <tr className={financialDetailsClass}>
                        <td className={tableClassBold}>Remuneration Amount</td>
                        <td className={tableClass}>
                          {riskPlanDetails.intermediaryRemunerationMethod ===
                            "Flat Fee" && (
                            <span>
                              CAD {riskPlanDetails.coverageFixedAmount}
                            </span>
                          )}
                          {riskPlanDetails.intermediaryRemunerationMethod ===
                            "Flat Commission" && (
                            <span>
                              {
                                riskPlanDetails.intermediaryRemunerationCommission
                              }
                              % of premiums
                            </span>
                          )}
                        </td>
                      </tr>
                      <tr className={financialDetailsClass}>
                        <td className={tableClassBold}>Total Sum Insured</td>
                        <td className={tableClass}>
                          CAD {riskPlanDetails.totalSumInsured}
                        </td>
                      </tr>
                      <tr className={financialDetailsClass}>
                        <td className={tableClassBold}>Total Premiums</td>
                        <td className={tableClass}>
                          {riskPlanDetails.totalPremium}
                        </td>
                      </tr>
                      <tr className={financialDetailsClass}>
                        <td className={tableClassBold}>Headcount</td>
                        <td className={tableClass}>
                          {riskPlanDetails.headcount}
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <div>
                  <h2 className="my-4 block text-xl font-semibold text-info ">
                    Administration Details
                  </h2>
                  <table className="min-w-full divide-x divide-y divide-white ">
                    <thead>
                      <tr className="divide-x divide-white bg-info text-white">
                        <th className="w-1/4 py-2 pl-2 text-left">Category</th>
                        <th className="w-3/4 py-2 pl-2 text-left">
                          Description
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr className={adminDetailsClass}>
                        <td className={tableClassBold}>Invoicing</td>
                        <td className={tableClass}>
                          {riskPlanDetails.invoicingDescription}
                        </td>
                      </tr>
                      <tr className={adminDetailsClass}>
                        <td className={tableClassBold}>Employee Enrollment</td>
                        <td className={tableClass}>
                          <p className="whitespace-pre">
                            {riskPlanDetails.employeeEnrollmentDescription}
                          </p>
                        </td>
                      </tr>
                      <tr className={adminDetailsClass}>
                        <td className={tableClassBold}>Employee Termination</td>
                        <td className={tableClass}>
                          <p className="whitespace-pre">
                            {riskPlanDetails.employeeTerminationDescription}
                          </p>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          )}
        </Container>
        <Footer />
      </main>
    </>
  );
}
